machine:
  services:
    - docker
    
dependencies:
  cache_directories:
    - $HOME/.pebble-sdk
  pre:
    - docker pull skippa/docker-pebble
    - mkdir $HOME/.pebble-sdk
    - chmod a+rwx $HOME/.pebble-sdk
    - pwd
    - echo $PWD $HOME
    - docker run --rm -it -v $HOME/.pebble-sdk:/home/pebble/.pebble-sdk skippa/docker-pebble /bin/sh -c "yes | python /tool/pebble.py sdk install latest"
    - touch ~/.pebble-sdk/ENABLE_ANALYTICS
    
test:
  post:
    - cd app
    - docker run --rm -it -v $PWD:/pebble -v $HOME/.pebble-sdk:/home/pebble/.pebble-sdk skippa/docker-pebble /bin/sh -c "python /tool/pebble.py build"
